A, B := Int | Top | A -> B | mu a. A
~ ::= < | =a*
m ::= + | -
T ::= . | T, a_m

=============
T |-{m} A ~ B
=============

T |-{m} Int = Int

T |-{m} Top = Top

A != Top
---------------
T |-{m} A < Top

a_m in T
-------------
T |-{m} a = a 

a_!m in T
----------------
T |-{m} a ={a} a

T, a_m |- A ~ B 
---------------------------
T |-{m} mu a. A ~\a mu a. B

T |-{!m} C ~1 A    T |-{m} B ~2 D 
---------------------------------
T |-{m} A -> B (~1 & ~2)  C -> D 

< less than
= equal
=a* equal on the condition that a is free variable


Logic Table for Modes:

~1   | ~2 | ~1 & ~2
-------------------
 <   | <   | <
 <   | =   | <
 =   | <   | <
 =a* | =b* | =(a + b)* 
 =a+ | <   | ERROR
 <   | =a+ | ERROR

Example 1: Works as expected

+a |-{-} a < Top             +a |-{+} a = a
-------------------------------------------
+a |- Top -> a < a -> a
-------------------------------------
. |-{+} mu a . Top -> a < mu a . a -> a

Example 2: Fails as expected

+a |-{-} a ={a} a            +a |-{+} Int < Top a
-------------------------------------------
+a |- a -> Int (=a & <) a -> Top       (fails here: (=a & <) ==> ERROR) 
---------------------------------------------
. |-{+} mu a . a -> Int ERROR mu a . a -> Top

Example 3: Works as expected

+a |-{-} a ={a} a           +a |-{+} a = a
------------------------------------------
+a |-{+} a -> a ={a} a -> a
------------------------------------
. |-{+} mu a. a -> a = mu a. a -> a

Example 4: Works as expected

see example 3
------------------------------------
. |-{+} mu a . a -> a = mu a. a -> a      . |-{-} Int < Top
-----------------------------------------------------------
. |-{-} (mu a . a -> a) -> Int < (mu a . a -> a) -> Top

Example 5: Fails as expected

                      +a |-{-} a ={a} a   +a |-{+} a = a 
                      ----------------------------------  
+a |-{-} Int < Top    +a |-{+} a -> a ={a} a -> a
-------------------------------------------------
+a |-{+} Top -> a -> a  ERROR  Int -> a -> a
----------------------------------------------------
. |-{+} mu a. Top -> a -> a ERROR mu a . Int -> a -> a


Counter Example:

Works, but should be rejected

+a, +b |-{-} b ={b} b
+a, +b |-{+} a = a 
--------------------------------------
+a, +b |-{+} b -> a ={b} b -> a
--------------------------------------
+a |-{+} mu b. b -> a = mu b. b -> a        +a |-{-} a < Top
------------------------------------------------------------------
+a |-{+} Top -> (mu b. b -> a) < a -> (mu b. b -> a)
------------------------------------------------------------------
. |-{+} mu a. Top -> (mu b. b -> a) < mu a. a -> (mu b. b -> a)


In the refined rules

+a, +b |-{-} b ={b} b  |> {b}
+a, +b |-{+} a = a     |> {}
--------------------------------------
+a, +b |-{+} b -> a ={b} b -> a    |> {b}
--------------------------------------
+a |-{+} mu b. b -> a ={} mu b. b -> a   |> {a} = {b} \u FV(mu b. b -> a) \ {b}         
+a |-{-} a < Top                         |> {}
------------------------------------------------------------------
+a |-{+} Top -> (mu b. b -> a) < a -> (mu b. b -> a) |> {a}  
------------------------------------------------------------------ fail here because a  is in   ... |> {a} 
. |-{+} mu a. Top -> (mu b. b -> a) < mu a. a -> (mu b. b -> a)


Problem:

needs to check 

posvar (a) (Top -> (mu b. b -> a)) (a -> (mu b. b -> a))



L17:

... |- Top <: B, fails
------------------------------------------------------------------
A <: B,  (mu b. b -> A) <: (mu b. b -> B),
(mu b. b -> B) <: (mu b. b -> A), A <: B
|- B -> (mu b. b -> B) <: Top -> (mu b. b -> A)
------------------------------------------------------------------
A <: B,  (mu b. b -> A) <: (mu b. b -> B),
(mu b. b -> B) <: (mu b. b -> A)
|- (mu b. b -> B) -> B <: (mu b. b -> A) -> A
------------------------------------------------------------------
A <: B,  (mu b. b -> A) <: (mu b. b -> B)
|- (mu b. b -> B) <: (mu b. b -> A)
------------------------------------------------------------------
A <: B,  (mu b. b -> A) <: (mu b. b -> B)
|- (mu b. b -> A) -> A <: (mu b. b -> B) -> B
------------------------------------------------------------------
A <: B
|- Top -> (mu b. b -> A) < B -> (mu b. b -> B)
------------------------------------------------------------------
. |- mu a. Top -> (mu b. b -> a) < mu a. a -> (mu b. b -> a)


A = mu a. Top -> (mu b. b -> a)
B = mu a. a -> (mu b. b -> a)